data Bit is Zero | One end

bitAnd :: Bit -> Bit -> Bit is vhdl "prim_bitAnd" bitAnd end
bitNot :: Bit -> Bit is vhdl "prim_bitNot" bitNot end

go :: <ReT Bit Bit I><Bit>
is
     bind x <- signal Zero
  in bind y <- case x of
               { One  -> signal Zero
               ; Zero -> signal x
               }
  in bind z <- signal (bitAnd (case y of { One -> x ; Zero -> bitAnd x x }) y)
  in           go
end

start :: <ReT Bit Bit I><Bit>
is
  go
end
